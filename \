import { z } from "zod";

export type TOverlayLocalStorageSave = {
  top: string;
  left: string;
  [key: string]: string;
};

export enum EAlertType {
  All = "ALL",
}

const SPosition = z.object({
  top: z.string().refine((el) => el.endsWith("px")),
  left: z.string().refine((el) => el.endsWith("px")),
});

const SSize = z.object({
  width: z.string().refine((el) => el.endsWith("px")),
  height: z.string().refine((el) => el.endsWith("px")),
});

const SOverlayElement = z.discriminatedUnion("element", [
  z.object({
    element: z.literal("chat"),
    uuid: z.string().uuid(),
    position: SPosition,
    size: SSize,
  }),
  z.object({
    element: z.literal("text"),
    uuid: z.string().uuid(),
    position: SPosition,
    size: SSize,
    content: z.string(),
  }),
  z.object({
    element: z.literal("alert"),
    uuid: z.string().uuid(),
    position: SPosition,
    size: SSize,
    alertType: z.enum(["all", "subscription", "follow", "raid", "donate", "other"]),
  }),
]);

export const SOverlaySave = z.array(SOverlayElement);

export type TOverlaySaveElement = z.infer<typeof SOverlayElement>;
export type TOverlaySave = z.infer<typeof SOverlaySave>;
